# Custom AI Architecture Diagram

```
┌────────────────────────────────────────────────────────────────────────────┐
│                         AI INTERVIEW PLATFORM                               │
│                    Custom ML Question Generation System                     │
└────────────────────────────────────────────────────────────────────────────┘

                                  ┌─────────────┐
                                  │   Client    │
                                  │  (Frontend) │
                                  └──────┬──────┘
                                         │
                                         │ HTTP Request
                                         │ POST /api/interviews/questions
                                         │ { stream, difficulty, count }
                                         │
                                         ▼
                   ┌─────────────────────────────────────────────┐
                   │          Express API Server                  │
                   │         (routes/interview.js)                │
                   └───────────────────┬─────────────────────────┘
                                       │
                                       │ Call AIService
                                       │
                                       ▼
        ┌──────────────────────────────────────────────────────────────┐
        │                      AIService                                │
        │              (services/aiService.js)                          │
        │                                                                │
        │  ┌──────────────────────────────────────────────────────┐   │
        │  │ generateQuestions(stream, difficulty, count,         │   │
        │  │                   useCustomAI=true)                  │   │
        │  └────────────────────────┬─────────────────────────────┘   │
        │                           │                                   │
        │          ┌────────────────┴────────────────┐                 │
        │          │                                  │                 │
        │          ▼                                  ▼                 │
        │  ┌───────────────┐                ┌────────────────┐        │
        │  │  Custom ML    │                │   OpenAI API   │        │
        │  │  (Primary)    │                │   (Fallback)   │        │
        │  └───────┬───────┘                └────────────────┘        │
        └──────────┼────────────────────────────────────────────────────┘
                   │
                   ▼
        ┌──────────────────────────────────────────────────────────────┐
        │               CUSTOM ML SYSTEM (Primary Path)                 │
        └──────────────────────────────────────────────────────────────┘
                   │
                   │
      ┌────────────┼────────────────────────┐
      │            │                         │
      ▼            ▼                         ▼
┌───────────┐ ┌─────────────────┐  ┌──────────────────┐
│ Training  │ │   Difficulty    │  │    Question      │
│  Dataset  │ │   Predictor     │  │   Generator      │
│           │ │                 │  │                  │
│ 40+       │ │ ML Model for    │  │ 4 Strategies:    │
│ Questions │ │ predicting      │  │ • Template       │
│           │ │ Easy/Medium/    │  │ • Concept        │
│ Concepts  │ │ Hard            │  │ • Example        │
│ Keywords  │ │                 │  │ • Hybrid         │
│ Templates │ │ Features:       │  │                  │
│           │ │ • Tech terms    │  │ Validation:      │
│           │ │ • Complexity    │  │ • Duplicates     │
│           │ │ • Question type │  │ • Length         │
│           │ │ • Impl. req.    │  │ • Quality        │
└───────────┘ └─────────────────┘  └──────────────────┘
      │                │                      │
      │                │                      │
      │                └──────────┬───────────┘
      │                           │
      │                           ▼
      │              ┌────────────────────────┐
      │              │  Generated Questions    │
      │              │  with ML Metadata       │
      │              │                         │
      │              │ • question              │
      │              │ • predictedDifficulty   │
      │              │ • difficultyScore       │
      │              │ • confidence            │
      │              │ • generationStrategy    │
      │              │ • category              │
      │              └────────────┬────────────┘
      │                           │
      │                           ▼
      │                    Return to Client
      │
      └────────────► Can be used for retraining


═══════════════════════════════════════════════════════════════════

                        DETAILED WORKFLOW

Step 1: Request Received
┌─────────────────────────────────────────────────────────────┐
│ Client Request:                                              │
│ {                                                            │
│   stream: "Computer Science",                               │
│   difficulty: "Medium",  // or "auto" for ML prediction    │
│   count: 5                                                   │
│ }                                                            │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
Step 2: Difficulty Prediction (if auto)
┌─────────────────────────────────────────────────────────────┐
│ Difficulty Predictor:                                        │
│                                                              │
│ Input: "Generate Computer Science questions"                │
│                                                              │
│ Feature Extraction:                                          │
│ ├─ Technical terms: 0                                       │
│ ├─ Question type: explanation                               │
│ ├─ Concept depth: 0                                         │
│ ├─ Implementation: false                                    │
│ └─ Advanced keywords: 0                                     │
│                                                              │
│ Calculation: score = Σ(feature × weight)                   │
│                                                              │
│ Output:                                                      │
│ {                                                            │
│   difficulty: "Easy",                                       │
│   score: 1.5,                                               │
│   confidence: 50%                                           │
│ }                                                            │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
Step 3: Question Generation
┌─────────────────────────────────────────────────────────────┐
│ Question Generator:                                          │
│                                                              │
│ For each question (1 to count):                             │
│                                                              │
│   1. Select Strategy:                                       │
│      ├─ Question 1: template-based                          │
│      ├─ Question 2: concept-based                           │
│      ├─ Question 3: example-based                           │
│      └─ Question 4: hybrid                                  │
│                                                              │
│   2. Generate Question:                                     │
│      ├─ Get relevant concepts                               │
│      ├─ Apply generation strategy                           │
│      └─ Create question text                                │
│                                                              │
│   3. Validate:                                              │
│      ├─ Check length (>20 chars)                            │
│      ├─ Check duplicates (similarity <80%)                  │
│      └─ Verify format (has ? or imperative)                 │
│                                                              │
│   4. Verify Difficulty:                                     │
│      ├─ Predict difficulty of generated question            │
│      ├─ Calculate confidence                                │
│      └─ Check if matches target                             │
│                                                              │
│   5. Add Metadata:                                          │
│      └─ Attach ML predictions and stats                     │
│                                                              │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
Step 4: Return Results
┌─────────────────────────────────────────────────────────────┐
│ Response to Client:                                          │
│ [                                                            │
│   {                                                          │
│     question: "What is the difference between arrays...",   │
│     category: "Data Structures",                            │
│     mlGenerated: true,                                       │
│     model: "custom-ml-model",                                │
│     predictedDifficulty: "Easy",                            │
│     difficultyScore: 1.55,                                  │
│     confidence: 80,                                          │
│     generationStrategy: "template-based",                   │
│     generatedAt: "2025-12-30T..."                           │
│   },                                                         │
│   // ... more questions                                     │
│ ]                                                            │
└─────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════

                    GENERATION STRATEGIES

┌─────────────────────────────────────────────────────────────┐
│ 1. Template-Based                                            │
│                                                              │
│    Template: "What is {concept}? Explain with example."     │
│    Concepts: ["array", "linked list", "stack"]              │
│    Result:   "What is an array? Explain with example."      │
│                                                              │
│    ✓ Fast                                                   │
│    ✓ Consistent format                                      │
│    ✓ Professional language                                  │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│ 2. Concept-Based                                             │
│                                                              │
│    Concept: "binary trees"                                  │
│    Related: ["recursion", "traversal"]                      │
│    Advanced: ["AVL trees", "Red-Black trees"]               │
│                                                              │
│    Easy:   "What is recursion for binary trees?"           │
│    Medium: "Compare binary trees with AVL trees"            │
│    Hard:   "Design solution using Red-Black trees"          │
│                                                              │
│    ✓ Contextually relevant                                  │
│    ✓ Follows concept hierarchy                              │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│ 3. Example-Based                                             │
│                                                              │
│    Original: "Explain binary search and complexity"         │
│                                                              │
│    Variations:                                               │
│    • Change verb: "Describe binary search..."               │
│    • Add context: "...in a production environment"          │
│    • Add comparison: "...and compare with linear search"    │
│                                                              │
│    ✓ Based on real questions                                │
│    ✓ Proven to work                                         │
│    ✓ Avoids repetition                                      │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│ 4. Hybrid                                                    │
│                                                              │
│    Uses ML confidence to choose strategy:                   │
│    • High confidence (>70%): Concept-based                  │
│    • Low confidence (<70%): Template-based                  │
│                                                              │
│    ✓ Adaptive                                               │
│    ✓ Best of both worlds                                    │
└─────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════

                    PERFORMANCE METRICS

┌────────────────────────────────────────────────────────────────┐
│                   Custom ML vs OpenAI                           │
├────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Metric         │  Custom ML    │  OpenAI       │  Advantage  │
│  ───────────────┼───────────────┼───────────────┼──────────── │
│  Speed          │  0.4ms/q      │  1-3s/q       │  2500-7500x │
│  Cost           │  $0           │  ~$0.01/q     │  100%       │
│  Offline        │  ✅ Yes       │  ❌ No        │  ✓          │
│  Consistency    │  High         │  Medium       │  ✓          │
│  Quality        │  Good         │  Very Good    │  -          │
│  Customization  │  Full         │  Limited      │  ✓          │
│  Training       │  ✅ Yes       │  ❌ No        │  ✓          │
│                                                                 │
└────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════

                    FILE STRUCTURE

backend/
├── ml/                              [NEW ML SYSTEM]
│   ├── trainingData.js              Training dataset (40+ questions)
│   ├── difficultyPredictor.js       ML difficulty prediction model
│   ├── questionGenerator.js         Question generation engine
│   ├── train.js                     Training script
│   ├── test.js                      Testing script
│   ├── README.md                    Complete documentation
│   ├── QUICKSTART.md               Quick start guide
│   └── PROMPT_TEMPLATE.md          Prompt implementation guide
│
├── services/
│   └── aiService.js                 [ENHANCED] Integrated ML + OpenAI
│
├── routes/
│   └── interview.js                 API endpoints (use aiService)
│
└── package.json                     [UPDATED] Added npm scripts


═══════════════════════════════════════════════════════════════════

                    USAGE EXAMPLE

// Simple usage with custom ML
const questions = await AIService.generateQuestions(
  'Computer Science',  // Stream
  'Medium',           // Difficulty
  5,                  // Count
  true                // Use Custom ML ← Key parameter!
);

// Auto-predict difficulty
const questions = await AIService.generateQuestions(
  'Data Science',
  'auto',  // Let ML decide
  5,
  true
);

// Get model statistics
const stats = AIService.getMLModelStats();

// Predict custom question difficulty
const prediction = AIService.predictQuestionDifficulty(
  'Computer Science',
  'Algorithms',
  'Your custom question here'
);

═══════════════════════════════════════════════════════════════════
```
